sig2 = 1^2;
Rrr4 = [1.2+sig2 0.28 0.4 0;
       0.28 1.2+sig2 0.28 0.4;
       0.4 0.28 1.2+sig2 0.28;
       0 0.4 0.28 1.2+sig2];
Rsr4 = [1; 0.2; 0.4; 0];
h4 = Rrr4\Rsr4;

Rrr6 = [1.2+sig2 0.28 0.4 0 0 0;
      0.28 1.2+sig2 0.28 0.4 0 0 ;
      0.4 0.28 1.2+sig2 0.28 0.4 0;
      0 0.4 0.28 1.2+sig2 0.28 0.4;
      0 0 0.4 0.28 1.2+sig2 0.28;
      0 0 0 0.4 0.28 1.2+sig2];
      
Rsr6 = [1; 0.2; 0.4; 0; 0; 0];
h6 = Rrr6\Rsr6;


Rrr10 = [1.2+sig2 0.28 0.4 0 0 0 0 0 0 0;
      0.28 1.2+sig2 0.28 0.4 0 0 0 0 0 0;
      0.4 0.28 1.2+sig2 0.28 0.4 0 0 0 0 0;
      0 0.4 0.28 1.2+sig2 0.28 0.4 0 0 0 0;
      0 0 0.4 0.28 1.2+sig2 0.28 0.4 0 0 0;
      0 0 0 0.4 0.28 1.2+sig2 0.28 0.4 0 0;
      0 0 0 0 0.4 0.28 1.2+sig2 0.28 0.4 0;
      0 0 0 0 0 0.4 0.28 1.2+sig2 0.28 0.4;
      0 0 0 0 0 0 0.4 0.28 1.2+sig2 0.28;
      0 0 0 0 0 0 0 0.4 0.28 1.2+sig2];
      
Rsr10 = [1; 0.2; 0.4; 0; 0; 0; 0; 0; 0; 0];
h10 = Rrr10\Rsr10;

s = randi(2, 1000, 1)*2 -3;
d = normrnd(0, sig2, 1000, 1);
c = [1; 0.2; 0.4];

z = filter(c, 1, s);
r = z + d;
s_hat4 = filter(h4, 1, r);
s_hat6 = filter(h6, 1, r);
s_hat10 = filter(h10, 1, r);

MSE = [mean((s - s_hat4).^2); mean((s - s_hat6).^2); mean((s - s_hat10).^2)];
N = [4; 6; 10];
table(N, MSE)